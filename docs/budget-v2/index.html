<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>KGB Finance 2025 â€” Budget</title>

  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#7c9cf5">
  <link rel="icon" href="icons/icon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">

  <link rel="stylesheet" href="styles.css?v=20251219165610" />

  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js?v=20251219165610"></script>
  <script defer src="app.js?v=20251219165610"></script>
  <script defer src="../common/kgb_year_dropdown.js?v=20251219165610"></script>
</head>

<body>
<header class="bar">
  <h1>ðŸ’° KGB Finance 2025 â€” Budget</h1>

  <nav class="tabs" aria-label="Navigatie">
    <button type="button" data-tab="dashboard" class="tab active">Dashboard</button>
    <button type="button" data-tab="budget" class="tab">Budget</button>
    <button type="button" data-tab="theme" class="tab">Thema</button>

    <span id="yearMount" style="margin-left:10px;"></span>
  </nav>
</header>

<main>
  <!-- DASHBOARD -->
  <section id="dashboard" class="panel active">
    <div class="cards">
      <div class="card"><div class="k">Inkomen</div><div class="v" id="totIncome">0,00</div></div>
      <div class="card"><div class="k">Uitgave</div><div class="v" id="totExpense">0,00</div></div>
      <div class="card"><div class="k">Saldo</div><div class="v ok" id="totSaldo">0,00</div></div>
    </div>

    <div class="chartBar">
      <div class="left">
        <strong>Grafiek:</strong>
        <label><input type="radio" name="ctype" value="line" checked> Lijn</label>
        <label><input type="radio" name="ctype" value="bar"> Balk</label>
        <label><input type="radio" name="ctype" value="pie"> Cirkel</label>
      </div>
      <div class="right"></div>
    </div>

    <canvas id="saldoChart" height="160"></canvas>
  </section>

  <!-- BUDGET -->
  <section id="budget" class="panel">
    <h2>ðŸ“‹ Budget</h2>

    <form id="addBudget" class="addForm" autocomplete="off">
      <input id="b_date" type="date" required />
      <input id="b_cat" type="text" placeholder="Categorie" required />
      <input id="b_desc" type="text" placeholder="Omschrijving" />
      <input id="b_inc" type="number" step="0.01" inputmode="decimal" placeholder="Inkomen">
      <input id="b_exp" type="number" step="0.01" inputmode="decimal" placeholder="Uitgave">
      <button type="submit">âž• Toevoegen</button>
    </form>

    <div class="tableWrap">
      <table id="tblBudget" class="grid">
        <thead>
          <tr>
            <th>Datum</th>
            <th>Categorie</th>
            <th>Omschrijving</th>
            <th>Inkomen</th>
            <th>Uitgave</th>
            <th>Saldo (loopt)</th>
            <th>Acties</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <!-- THEMA -->
  <section id="theme" class="panel">
    <h2>ðŸŽ¨ Thema</h2>

    <div class="themeBox">
  <label>Jaar:
    <select id="yearSelect"></select>
  </label>

  <label>Onderdeel:
    <select id="themeTarget">
      <option value="bg">Achtergrond</option>
<option value="card">Kaarten/Tabel</option>
<option value="acc">Accent/Knoppen</option>
<option value="grid">Rasterlijnen</option>
<option value="txt">Tekst</option>
    </select>
  </label>

  <div id="swatches" class="swatches"></div>

  <div class="sliders">
    <label>Intensiteit <input id="intensity" type="range" min="50" max="150" value="100"></label>
    <label>Raster <input id="gridIntensity" type="range" min="50" max="150" value="100"></label>
  </div>

  <div class="themeBtns">
    <button id="themeReset" type="button">Reset</button>
    <button id="themeSave" type="button">Opslaan</button>
  </div>
</div>
  </section>

<!-- KGB_COLOR_PICKER_UI v1 -->
<div id="kgbThemePicker" class="kgb-theme-only">

<div class="kgb-theme-picker card" style="margin-top:12px;">
  <div class="row" style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
    <label style="display:flex;gap:8px;align-items:center;">
      <span>Onderdeel:</span>
      <select id="kgbTarget" style="min-width:180px;">
        <option value="bg">Achtergrond</option>
        <option value="card">Kaarten/Tabel</option>
        <option value="acc">Accent/Knoppen</option>
        <option value="grid">Rasterlijnen</option>
        <option value="txt">Tekst</option>
      </select>
    </label>
    <label style="display:flex;gap:8px;align-items:center;">
      <span>Kleur:</span>
      <input id="kgbColor" type="color" value="#7c9cf5" /> <span id="kgbColorValue" class="kgb-color-value">#7c9cf5</span>
    </label>
    <button id="kgbApply" type="button">Toepassen</button>
    <button id="kgbSave" type="button">Opslaan</button>
    <button id="kgbReset" type="button">Reset</button>
  </div>

  <div id="kgbSwatches" class="swatches" style="margin-top:10px;"></div>
</div>

<script>
/* KGB_COLOR_PICKER_LOGIC v1 */
(() => {
  const THEME_KEY = "kgb_finance_theme_v1";
  const pastel = ["#A0C4FF","#BDB2FF","#FFC6FF","#9BF6FF","#FDFFB6","#CAFFBF","#FFADAD","#FFD6A5","#E4C1F9","#CDEAC0","#B9FBC0","#FFD5C2","#F7DAD9","#E2ECE9","#E6CBA8","#E4C6A1","#E8AEB7","#A0CED9","#E8D7FF","#A3D5D3","#D9E8E3","#FFF3B0","#FFCFD2","#F1E3FF","#C8E7FF","#E3F8FF","#FFEEE8","#FFE3E3","#E5FFFB","#F6E6FF","#F9D8D6","#D7F9F1","#F8E8C6","#FBE7E1","#E0F7FA","#E8F5E9","#FFEBEE","#FFFDE7","#EDE7F6","#E3F2FD","#FCE4EC","#F3E5F5","#FFECB3","#D1C4E9","#BBDEFB","#C8E6C9","#F0F4C3","#DCEDC8"];
  const def = {bg:"#f5f7ff",card:"#ffffff",acc:"#7c9cf5",txt:"#0f172a",grid:"#e2e8f0",intensity:100,gridIntensity:100};
  const $ = (s) => document.querySelector(s);

  function colToRgb(hex){hex=(hex||"").replace('#',''); if(hex.length===3) hex=hex.split('').map(x=>x+x).join(''); const n=parseInt(hex,16); return {r:(n>>16)&255,g:(n>>8)&255,b:n&255};}
  function adjust(hex,f){const {r,g,b}=colToRgb(hex); const adj=(v)=>Math.max(0,Math.min(255, Math.round(v*(f/100)))); return `rgb(${adj(r)}, ${adj(g)}, ${adj(b)})`;}
  function applyTheme(t){
    const root = document.documentElement;
    root.style.setProperty('--bg',   adjust(t.bg,   t.intensity||100));
    root.style.setProperty('--card', adjust(t.card, t.intensity||100));
    root.style.setProperty('--acc',  adjust(t.acc,  t.intensity||100));
    root.style.setProperty('--grid', adjust(t.grid, t.gridIntensity||100));
    root.style.setProperty('--txt',  t.txt || "#0f172a");
  }
  function load(){ try { return JSON.parse(localStorage.getItem(THEME_KEY)||"null") || {...def}; } catch(e){ return {...def}; } }
  function save(t){ localStorage.setItem(THEME_KEY, JSON.stringify(t)); }

  function setPartColor(t){
    const part = $("#kgbTarget").value;
    const col  = $("#kgbColor").value;
    if (part === "bg") t.bg = col;
    else if (part === "card") t.card = col;
    else if (part === "acc") t.acc = col;
    else if (part === "grid") t.grid = col;
    else t.txt = col;
    applyTheme(t);
  }

  function buildSwatches(t){
    const box = $("#kgbSwatches");
    if (!box) return;
    box.innerHTML = "";
    pastel.forEach(c => {
      const b = document.createElement("button");
      b.type = "button";
      b.className = "swatch";
      b.style.background = c;
      b.title = c;
      b.addEventListener("click", () => {
        $("#kgbColor").value = c;
        setPartColor(t);
      });
      box.appendChild(b);
    });
  }

  window.addEventListener("DOMContentLoaded", () => {
    const t = load();
    applyTheme(t);
    buildSwatches(t);

    $("#kgbApply").addEventListener("click", () => setPartColor(t));
    $("#kgbSave").addEventListener("click", () => { save(t); alert("Thema opgeslagen."); });
    $("#kgbReset").addEventListener("click", () => {
      Object.assign(t, def);
      applyTheme(t);
      $("#kgbColor").value = t.acc;
      buildSwatches(t);
    });
  });
})();
</script>
</div>


</main>

<footer><small>Â© KGB Finance 2025</small></footer>

<!-- Tabs: ALWAYS work, even if app.js is broken -->
<script>
(function () {
  const tabs = Array.from(document.querySelectorAll('.tabs .tab[data-tab]'));
  const panels = Array.from(document.querySelectorAll('main .panel'));

  function setActive(name) {
    tabs.forEach(b => b.classList.toggle('active', b.dataset.tab === name));
    panels.forEach(p => p.classList.toggle('active', p.id === name));
  }

  tabs.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      setActive(btn.dataset.tab);
    });
  });

  // ensure initial state is correct
  const initial = (tabs.find(b => b.classList.contains('active')) || tabs[0])?.dataset?.tab || 'dashboard';
  setActive(initial);
})();
</script>

<!-- Service worker (laat staan als je PWA wil) -->
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    // SW disabled for budget-v2 (cache issues).catch(()=>{});
  });
}
</script>


<script>
/* KGB_THEME_VISIBILITY_LOGIC v1 */
(() => {
  const $ = (s) => document.querySelector(s);

  function isThemeActive(){
    // 1) Als er een tabknop "Thema" bestaat met aria-current/active class
    const themeBtn =
      Array.from(document.querySelectorAll("a,button")).find(x => (x.textContent||"").trim().toLowerCase() === "thema");
    if (themeBtn){
      const cls = (themeBtn.className||"").toLowerCase();
      if (cls.includes("active") || cls.includes("selected")) return true;
      if (themeBtn.getAttribute("aria-current") === "page") return true;
    }

    // 2) fallback: kijk naar zichtbaarheid van de thema-section (h2 "Thema")
    const h2 = Array.from(document.querySelectorAll("h1,h2,h3")).find(x => (x.textContent||"").trim().toLowerCase() === "thema");
    if (h2){
      const rect = h2.getBoundingClientRect();
      // als het thema-blok in de layout zit
      if (rect.width > 0 && rect.height > 0) return true;
    }

    // 3) fallback: url hint
    const u = new URL(location.href);
    if ((u.searchParams.get("tab")||"").toLowerCase() === "theme") return true;
    if ((location.hash||"").toLowerCase().includes("theme")) return true;

    return true; // als we het niet kunnen detecteren: toon (veilig)
  }

  function togglePicker(){
    const box = $("#kgbThemePicker");
    if (!box) return;
    box.classList.toggle("is-visible", isThemeActive());
  }

  function syncColorUI(){
    const color = $("#kgbColor");
    const label = $("#kgbColorValue");
    const target = $("#kgbTarget");
    if (!color || !label || !target) return;

    // probeer huidige theme uit localStorage te laden
    let t = null;
    try { t = JSON.parse(localStorage.getItem("kgb_finance_theme_v1") || "null"); } catch {}
    t = t || {};

    const part = target.value;
    const current =
      part === "bg"   ? (t.bg   || color.value) :
      part === "card" ? (t.card || color.value) :
      part === "acc"  ? (t.acc  || color.value) :
      part === "grid" ? (t.grid || color.value) :
                        (t.txt  || color.value);

    // zet picker op de juiste huidige kleur
    if (current) color.value = current;
    label.textContent = (color.value || "").toUpperCase();

    color.addEventListener("input", () => {
      label.textContent = (color.value || "").toUpperCase();
    });

    target.addEventListener("change", () => {
      // opnieuw sync naar gekozen onderdeel
      try { t = JSON.parse(localStorage.getItem("kgb_finance_theme_v1") || "null") || {}; } catch { t = {}; }
      const part2 = target.value;
      const cur2 =
        part2 === "bg"   ? (t.bg   || color.value) :
        part2 === "card" ? (t.card || color.value) :
        part2 === "acc"  ? (t.acc  || color.value) :
        part2 === "grid" ? (t.grid || color.value) :
                           (t.txt  || color.value);
      if (cur2) color.value = cur2;
      label.textContent = (color.value || "").toUpperCase();
    });
  }

  window.addEventListener("DOMContentLoaded", () => {
    togglePicker();
    syncColorUI();

    // klik op tabs -> opnieuw checken
    document.addEventListener("click", (e) => {
      const t = e.target;
      if (!t) return;
      const txt = (t.textContent||"").trim().toLowerCase();
      if (txt === "thema" || txt === "budget" || txt === "dashboard") {
        setTimeout(togglePicker, 50);
      }
    });
  });
})();
</script>


<script>
/* KGB_THEME_PICKER_FIX_V4 */
(() => {
  const THEME_KEY = "kgb_finance_theme_v1";
  const def = {bg:"#f5f7ff",card:"#ffffff",acc:"#7c9cf5",txt:"#0f172a",grid:"#e2e8f0",intensity:100,gridIntensity:100};
  const $ = (s, c=document) => c.querySelector(s);

  function colToRgb(hex){
    hex=(hex||"").replace('#','');
    if(hex.length===3) hex=hex.split('').map(x=>x+x).join('');
    const n=parseInt(hex,16);
    return {r:(n>>16)&255,g:(n>>8)&255,b:n&255};
  }
  function adjust(hex,f){
    const {r,g,b}=colToRgb(hex);
    const adj=(v)=>Math.max(0,Math.min(255, Math.round(v*(f/100))));
    return `rgb(${adj(r)}, ${adj(g)}, ${adj(b)})`;
  }
  function applyTheme(t){
    const root = document.documentElement;
    root.style.setProperty('--bg',   adjust(t.bg,   t.intensity||100));
    root.style.setProperty('--card', adjust(t.card, t.intensity||100));
    root.style.setProperty('--acc',  adjust(t.acc,  t.intensity||100));
    root.style.setProperty('--grid', adjust(t.grid, t.gridIntensity||100));
    root.style.setProperty('--txt',  t.txt || "#0f172a");
  }
  function load(){
    try { return JSON.parse(localStorage.getItem(THEME_KEY)||"null") || {...def}; }
    catch { return {...def}; }
  }
  function save(t){ localStorage.setItem(THEME_KEY, JSON.stringify(t)); }

  // Vind de "Thema" sectie (container waar het echte thema-paneel in zit)
  function findThemeAnchor(){
    const h = Array.from(document.querySelectorAll("h1,h2,h3"))
      .find(x => (x.textContent||"").trim().toLowerCase() === "thema");
    if (!h) return null;
    // neem de dichtste card/panel/section rond die heading
    return h.closest("section,.card,.panel,main") || h.parentElement;
  }

  // Toon alleen als Thema zichtbaar is (als anchor in layout zit)
  function isVisible(el){
    if (!el) return false;
    const r = el.getBoundingClientRect();
    return r.width > 0 && r.height > 0 && el.offsetParent !== null;
  }

  function placePicker(){
    const picker = $("#kgbThemePicker");
    if (!picker) return;

    const anchor = findThemeAnchor();
    if (!anchor) return;

    // Zorg dat picker NA de bestaande thema-controls staat
    // (dus in dezelfde sectie)
    if (picker.parentElement !== anchor) {
      anchor.appendChild(picker);
    }

    picker.style.display = isVisible(anchor) ? "block" : "none";
  }

  function bindLiveControls(){
    const picker = $("#kgbThemePicker");
    if (!picker) return;

    // onze controls
    const target = $("#kgbTarget");
    const color  = $("#kgbColor");
    const label  = $("#kgbColorValue");
    const btnSave = $("#kgbSave");
    const btnReset = $("#kgbReset");
    const btnApply = $("#kgbApply");
    const swatches = $("#kgbSwatches");

    if (!target || !color) return;

    let t = load();
    applyTheme(t);

    function currentForPart(part){
      if (part === "bg") return t.bg;
      if (part === "card") return t.card;
      if (part === "acc") return t.acc;
      if (part === "grid") return t.grid;
      return t.txt;
    }

    function setPart(part, hex){
      if (part === "bg") t.bg = hex;
      else if (part === "card") t.card = hex;
      else if (part === "acc") t.acc = hex;
      else if (part === "grid") t.grid = hex;
      else t.txt = hex;
      applyTheme(t);
      if (label) label.textContent = (hex || "").toUpperCase();
    }

    function syncUI(){
      // zet picker op opgeslagen kleur van gekozen onderdeel
      const part = target.value;
      const hex = currentForPart(part) || color.value;
      if (hex) color.value = hex;
      if (label) label.textContent = (color.value || "").toUpperCase();
    }

    // LIVE: elke kleurwijziging meteen toepassen
    function onColorInput(){
      setPart(target.value, color.value);
    }

    // LIVE: swatch klik => meteen toepassen
    if (swatches && !swatches.dataset.kgbBound){
      swatches.dataset.kgbBound = "1";
      swatches.addEventListener("click", (e) => {
        const b = e.target.closest("button.swatch");
        if (!b) return;
        // background kan rgb(...) zijn; gebruik title als hex (die is gezet)
        const hex = b.title || color.value;
        color.value = hex;
        setPart(target.value, hex);
      });
    }

    // Kleur kiezen
    color.addEventListener("input", onColorInput);
    color.addEventListener("change", onColorInput);

    // Onderdeel veranderen => kleurknop springt mee
    target.addEventListener("change", syncUI);

    // Buttons (fallback)
    if (btnApply) btnApply.addEventListener("click", onColorInput);
    if (btnSave)  btnSave.addEventListener("click", () => { save(t); alert("Thema opgeslagen."); });
    if (btnReset) btnReset.addEventListener("click", () => { t = {...def}; applyTheme(t); syncUI(); });

    // init
    syncUI();
  }

  window.addEventListener("DOMContentLoaded", () => {
    // 1) zet picker op de juiste plaats + alleen tonen op thema
    placePicker();
    // 2) bind live gedrag
    bindLiveControls();

    // Re-check bij tab clicks (Dashboard/Budget/Thema)
    document.addEventListener("click", (e) => {
      const txt = (e.target?.textContent || "").trim().toLowerCase();
      if (txt === "dashboard" || txt === "budget" || txt === "thema") {
        setTimeout(placePicker, 60);
      }
    });

    // Extra zekerheid: na render/updates nog eens
    setTimeout(placePicker, 300);
    setTimeout(placePicker, 800);
  });
})();
</script>


<script>
/* KGB_THEME_MANAGER_V5 */
(() => {
  const THEME_KEY = "kgb_finance_theme_v1";
  const def = {bg:"#f5f7ff",card:"#ffffff",acc:"#7c9cf5",txt:"#0f172a",grid:"#e2e8f0",intensity:100,gridIntensity:100};

  const $  = (s,c=document)=>c.querySelector(s);
  const $$ = (s,c=document)=>Array.from(c.querySelectorAll(s));

  function colToRgb(hex){
    hex=(hex||"").replace('#','');
    if(hex.length===3) hex=hex.split('').map(x=>x+x).join('');
    const n=parseInt(hex,16);
    return {r:(n>>16)&255,g:(n>>8)&255,b:n&255};
  }
  function adjust(hex,f){
    const {r,g,b}=colToRgb(hex);
    const adj=(v)=>Math.max(0,Math.min(255, Math.round(v*(f/100))));
    return `rgb(${adj(r)}, ${adj(g)}, ${adj(b)})`;
  }

  function load(){
    try { return JSON.parse(localStorage.getItem(THEME_KEY)||"null") || {...def}; }
    catch { return {...def}; }
  }
  function save(t){ localStorage.setItem(THEME_KEY, JSON.stringify(t)); }

  function applyTheme(t){
    const root = document.documentElement;
    root.style.setProperty('--bg',   adjust(t.bg,   t.intensity||100));
    root.style.setProperty('--card', adjust(t.card, t.intensity||100));
    root.style.setProperty('--acc',  adjust(t.acc,  t.intensity||100));
    root.style.setProperty('--grid', adjust(t.grid, t.gridIntensity||100));
    root.style.setProperty('--txt',  t.txt || "#0f172a");
  }

  // Detecteer actieve tab en zet body attribuut => CSS kan picker tonen/verbergen
  function setTab(tab){
    document.body.setAttribute("data-kgb-tab", tab);
  }

  function detectTab(){
    // probeert actief knopje te vinden
    const buttons = $$("a,button");
    const norm = s => (s||"").trim().toLowerCase();

    // 1) actief via class/aria-current
    for (const b of buttons){
      const txt = norm(b.textContent);
      if (txt !== "dashboard" && txt !== "budget" && txt !== "thema") continue;
      const cls = norm(b.className);
      if (cls.includes("active") || cls.includes("selected") || b.getAttribute("aria-current")==="page") return txt;
    }

    // 2) fallback: kijk welke H2 zichtbaar is
    const hTheme = $$("h1,h2,h3").find(x => norm(x.textContent)==="thema");
    const hBudget = $$("h1,h2,h3").find(x => norm(x.textContent)==="budget");
    const vis = el => {
      if (!el) return false;
      const r = el.getBoundingClientRect();
      return r.width>0 && r.height>0 && el.offsetParent!==null;
    };
    if (vis(hTheme)) return "thema";
    if (vis(hBudget)) return "budget";
    return "dashboard";
  }

  // Bind de bestaande sliders (bovenste thema-paneel) zodat intensity/raster live werken
  function bindTopThemeSliders(){
    const hTheme = $$("h1,h2,h3").find(x => (x.textContent||"").trim().toLowerCase()==="thema");
    if (!hTheme) return;
    const area = hTheme.closest("section,.card,.panel,main") || document;

    // pak de eerste 2 range inputs binnen thema-blok
    const ranges = $$('input[type="range"]', area);
    if (ranges.length < 2) return;

    const intensity = ranges[0];
    const gridInt   = ranges[1];

    // geef ids als ze ontbreken (maar conflictvrij)
    if (!intensity.id) intensity.id = "kgbIntensityTop";
    if (!gridInt.id)   gridInt.id   = "kgbGridTop";

    const t = load();
    // zet startwaarden (als sliders 0..100)
    if (intensity.max) intensity.value = t.intensity ?? 100;
    if (gridInt.max)   gridInt.value   = t.gridIntensity ?? 100;

    const onInt = () => {
      const tt = load();
      tt.intensity = +intensity.value || 100;
      applyTheme(tt);
      save(tt);
    };
    const onGrid = () => {
      const tt = load();
      tt.gridIntensity = +gridInt.value || 100;
      applyTheme(tt);
      save(tt);
    };

    intensity.addEventListener("input", onInt);
    intensity.addEventListener("change", onInt);
    gridInt.addEventListener("input", onGrid);
    gridInt.addEventListener("change", onGrid);
  }

  // Fix: kleurknop altijd syncen met gekozen onderdeel in jouw extra picker
  function fixPickerColorButton(){
    const picker = $("#kgbThemePicker");
    if (!picker) return;

    const target = $("#kgbTarget");
    const color  = $("#kgbColor");
    if (!target || !color) return;

    const getPart = (t, p) =>
      p==="bg"?t.bg : p==="card"?t.card : p==="acc"?t.acc : p==="grid"?t.grid : t.txt;

    const sync = () => {
      const t = load();
      const hex = getPart(t, target.value) || "#7c9cf5";
      color.value = hex;
    };

    target.addEventListener("change", sync);
    sync();
  }

  function refresh(){
    const tab = detectTab();
    setTab(tab === "thema" ? "theme" : tab); // CSS verwacht "theme"
    const t = load();
    applyTheme(t);
  }

  window.addEventListener("DOMContentLoaded", () => {
    refresh();
    bindTopThemeSliders();
    fixPickerColorButton();

    // bij tab-clicks opnieuw evalueren
    document.addEventListener("click", (e) => {
      const txt = ((e.target?.textContent)||"").trim().toLowerCase();
      if (txt==="dashboard" || txt==="budget" || txt==="thema"){
        setTimeout(refresh, 60);
      }
    });

    // safety re-run
    setTimeout(refresh, 250);
    setTimeout(refresh, 900);
  });
})();
</script>

</body>
</html>
