<head><script id="kgb-base-fix">(function(){
  try{
    var p = location.pathname.replace(/[^/]+$/, '');
    document.write('<base href="'+ p.replace(/\/+$/,'/') +'">');
  }catch(e){}
})();</script>
<script id="kgb-fetch-shim">
(function(){
  if (window.__KGB_FETCH_SHIM__) return; window.__KGB_FETCH_SHIM__=true;
  const isDataUrl = (u)=>{ try{ const x = typeof u==='string'? u : (u&&u.url)||''; return /\/data\//.test(x) || /(^|[("'`])\.\/data\//.test(x); }catch(_){ return false; } };
  const ok = (text)=> new Response(new Blob([text], {type:'application/json'}), {status:200, headers:{'Content-Type':'application/json'}});
  // fetch()
  const origFetch = window.fetch;
  if (origFetch) {
    window.fetch = function(input, init){
      return origFetch(input, init).then(resp=>{
        if (!resp.ok && isDataUrl(resp.url)) { console.warn('KGB shim: vervang fout', resp.url, resp.status); return ok('{}'); }
        return resp;
      }).catch(err=>{
        const u = (typeof input==='string'? input : (input&&input.url)) || '';
        if (isDataUrl(u)) { console.warn('KGB shim: netwerkfout', u, err); return ok('{}'); }
        throw err;
      });
    };
  }
  // XMLHttpRequest()
  (function(){
    const X = window.XMLHttpRequest; if (!X) return;
    const P = X.prototype, open = P.open, send = P.send;
    P.open = function(m,u){ this.__kgb_url = u; return open.apply(this, arguments); };
    P.send = function(){
      if (isDataUrl(this.__kgb_url)) {
        this.addEventListener('load', ()=>{ if (this.status>=400) { try{ Object.defineProperty(this,'status',{value:200}); }catch(_){ } this.responseText='{}'; }});
        this.addEventListener('error', ()=>{ try{
          this.responseText='{}'; this.readyState=4; try{ Object.defineProperty(this,'status',{value:200}); }catch(_){}
          this.dispatchEvent(new Event('readystatechange')); this.dispatchEvent(new Event('load'));
        }catch(_){ }});
      }
      return send.apply(this, arguments);
    };
  })();
  console.log('KGB fetch-shim actief');
})();
</script>
</head>
<!doctype html>
<meta charset="utf-8">
<meta http-equiv="refresh" content="0; url=safe.html">
<title>Doorsturen…</title>
<p>Doorsturen naar <a href="safe.html">safe.html</a>…</p>
